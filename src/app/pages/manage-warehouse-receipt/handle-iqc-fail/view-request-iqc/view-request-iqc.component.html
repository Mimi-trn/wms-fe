<!-- Xem chi tiết yêu cầu IQC -->
<nz-row nzAlign="middle" class="mb-12">
  <app-breadcrumb nz-col [nzSpan]="24" *ngIf="isBreadcrumb" [listBreadCrumb]="breadcrumbs"
    [isHidden]="isHidden"></app-breadcrumb>
</nz-row>

<div class="common-bg">
  <nz-row>
    <h2 class="m-0">
      {{ "importRequest.iqc.title" | translate }}:
      {{ dataInformation.importRequestCode }}
    </h2>
  </nz-row>
  <nz-row nzAlign="top" nzJustify="start" [nzGutter]="{ xs: 0, sm: 0, md: 16, lg: 16, xl: 24, xxl: 24 }">
    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "manage.receipt.create.infor.type" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-select disabled nzShowSearch nzAllowClear nzPlaceHolder="-- Chọn --"
            [(ngModel)]="dataInformation.importType" class="w-100">
            <nz-option *ngFor="let option of listImportType" [nzValue]="option.importTypeId"
              [nzLabel]="option.importTypeName"></nz-option>
          </nz-select>
        </nz-col>
        <nz-col nzSpan="24" *ngIf="!dataInformation.importType">
          <span class="error-span"> This field is required </span>
        </nz-col>
      </nz-row>
    </nz-col>

    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12"
      *ngIf="dataInformation.importType == 3">
      <nz-row>
        <nz-col nzSpan="24">{{ "sidebar.export.child.exportRequest.child.woCode" | translate }}
          <span class="error-span">*</span></nz-col>
        <nz-col nzSpan="24">
          <nz-input-group [nzSuffix]="inputClearWoCode" [nzPrefix]="preFixWo" (click)="showPopoverWoCode()">
            <input readonly [disabled]="
                dataInformation.importType == 3 && dataInformation.status !== 0
                  ? true
                  : false
              " placeholder="-- Chọn -- " type="text" nz-input [(ngModel)]="dataInformation.woCode" />
          </nz-input-group>
          <ng-template #preFixWo>
            <span nz-popover nzPopoverTrigger="click" [nzPopoverContent]="contentWoCode" nzPopoverPlacement="bottomLeft"
              [nzPopoverVisible]="isOpenlistWo" (nzPopoverVisibleChange)="popoverVisibleChangeWoCode($event)">
            </span>
          </ng-template>
          <ng-template #inputClearWoCode>
            <span nz-icon class="ant-input-clear-icon" nzTheme="outline" nzType="down"></span>
          </ng-template>
          <ng-template #contentWoCode>
            <nz-table #tableWoCode [nzData]="listWo" nzBordered nzFrontPagination="false" nzShowPagination="false"
              style="width: 1000px" [nzScroll]="{ y: '500px' }" nzSize="small">
              <thead>
                <tr>
                  <th nzWidth="120px">
                    {{
                    "sidebar.export.child.exportRequest.child.woCode"
                    | translate
                    }}
                  </th>
                  <th nzWidth="120px">
                    {{
                    "sidebar.export.child.exportRequest.child.totalLotNumber"
                    | translate
                    }}
                  </th>
                  <th>
                    {{
                    "sidebar.export.child.exportRequest.child.startDate"
                    | translate
                    }}
                  </th>
                  <th>
                    {{
                    "sidebar.export.child.exportRequest.child.endDate"
                    | translate
                    }}
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <nz-input-group [nzSuffix]="woCode" [nzPrefix]="woCodePre" (keyup)="filterSearchWoCode($event)">
                      <input type="text" nz-input [(ngModel)]="dataFilterWoCode.woCode" />
                    </nz-input-group>
                    <ng-template #woCodePre>
                      <span nz-icon nzType="search" style="cursor: pointer; color: #d9d9d9"
                        (click)="filterSearchWoCode($event)"></span>
                    </ng-template>
                    <ng-template #woCode>
                      <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle"
                        *ngIf="dataFilterWoCode.woCode" (click)="clearWoCode('woCode')"></span>
                    </ng-template>
                  </td>
                  <td></td>
                  <td>
                    <nz-range-picker class="w-100" [(ngModel)]="dataFilterWoCode.startAt"
                      (ngModelChange)="onHandleFetchListWo()" [nzPlaceHolder]="[
                        'start_date' | translate,
                        'end_date' | translate
                      ]"></nz-range-picker>
                  </td>
                  <td>
                    <nz-range-picker class="w-100" [(ngModel)]="dataFilterWoCode.endAt"
                      (ngModelChange)="onHandleFetchListWo()" [nzPlaceHolder]="[
                        'start_date' | translate,
                        'end_date' | translate
                      ]"></nz-range-picker>
                  </td>
                </tr>
                <tr style="cursor: pointer" class="click-row" *ngFor="let row of tableWoCode.data"
                  (click)="chooseWoCode(row)">
                  <td>{{ row.woCode }}</td>
                  <td nzAlign="right">{{ row.totalLotNumber }}</td>
                  <td nzAlign="right">
                    {{ row.startDate | date : "dd/MM/YYYY" }}
                  </td>
                  <td nzAlign="right">
                    {{ row.endDate | date : "dd/MM/YYYY" }}
                  </td>
                </tr>
              </tbody>
            </nz-table>
            <nz-row *ngIf="totalWoCode" nzGutter="24" nzAlign="middle" nzJustify="center">
              <div nz-col nzSpan="24">
                <app-pagination [currentPage]="pageWoCode" [currentSize]="perPageWoCode" [total]="totalWoCode"
                  (emitPage)="paginationWoCode($event)"></app-pagination>
              </div>
            </nz-row>
          </ng-template>
        </nz-col>
        <nz-col nzSpan="24" *ngIf="!dataInformation.woCode">
          <span class="error-span">Bạn phải chọn mã WO</span>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12"
      *ngIf="dataInformation.importType == 3">
      <nz-row>
        <nz-col nzSpan="24">{{
          "sidebar.export.child.exportRequest.child.totalLotNumber" | translate
          }}</nz-col>
        <nz-col nzSpan="24">
          <input [disabled]="true" type="text" nz-input [(ngModel)]="dataInformation.totalLotNumber" />
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12"
      *ngIf="dataInformation.importType == 1">
      <nz-row>
        <nz-col nzSpan="24">{{
          "ui.receitp.GRN.create.supplier" | translate
          }}</nz-col>
        <nz-col nzSpan="24">
          <input [disabled]="true" type="text" nz-input [(ngModel)]="dataInformation.vendorName" />
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12"
      *ngIf="dataInformation.importType == 3">
      <nz-row>
        <nz-col nzSpan="24">{{
          "sidebar.export.child.exportRequest.child.startDate" | translate
          }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker [disabled]="true" nzPlaceHolder="dd/MM/yyyy" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.startDate"></nz-date-picker>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12"
      *ngIf="dataInformation.importType == 3">
      <nz-row>
        <nz-col nzSpan="24">{{ "sidebar.export.child.exportRequest.child.endDate" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker [disabled]="true" nzPlaceHolder="dd/MM/yyyy" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.endDate"></nz-date-picker>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "table.status" | translate }} </nz-col>
        <nz-col nzSpan="24">
          <nz-select disabled nzShowSearch nzAllowClear nzPlaceHolder="-- Chọn --" [(ngModel)]="dataInformation.status"
            class="w-100">
            <nz-option *ngFor="let option of listStatus" [nzValue]="option.value"
              [nzLabel]="option.label | translate"></nz-option>
          </nz-select>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 1" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "manage.receipt.create.infor.poCode" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-input-group nzPlaceHolder="-- Chọn --" class="w-100" nz-popover nzPopoverTrigger="click"
            [(nzPopoverVisible)]="isOpenTablePo">
            <input [disabled]="dataInformation.status != 0" type="text" nz-input [(ngModel)]="dataInformation.poCode"
              readonly />
          </nz-input-group>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 1" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "importRequest.handleIqcFail.deliveryAt" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker disabled nzPlaceHolder="-- Chọn --" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.deliveryAt"></nz-date-picker>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "createIqc.contract.contactCode" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-select disabled nzShowSearch nzAllowClear nzPlaceHolder="-- Chọn --"
            [(ngModel)]="dataInformation.consignmentContractCode" class="w-100">
            <nz-option *ngFor="let contract of listContract" [nzValue]="contract.consignmentContractCode"
              [nzLabel]="contract.consignmentContractCode"></nz-option>
          </nz-select>
        </nz-col>
        <nz-col nzSpan="24" *ngIf="!dataInformation.consignmentContractCode">
          <span class="error-span"> This field is required </span>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "createIqc.contract.documentDate" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker disabled nzPlaceHolder="-- Chọn --" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.contractCreatedAt"></nz-date-picker>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "createIqc.contract.customerCode" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-select disabled nzShowSearch nzAllowClear nzPlaceHolder="-- Chọn --"
            [(ngModel)]="dataInformation.customerCode" class="w-100">
            <nz-option [nzValue]="dataInformation.customerCode" [nzLabel]="dataInformation.customerCode"></nz-option>
          </nz-select>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "createIqc.contract.customerName" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <input nz-input disabled [(ngModel)]="dataInformation.customerName" />
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "createIqc.contract.address" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <input nz-input disabled [(ngModel)]="dataInformation.customerAddress" />
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "createIqc.contract.phoneNumber" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <input nz-input disabled [(ngModel)]="dataInformation.customerPhone" />
        </nz-col>
      </nz-row>
    </nz-col>

    <nz-col *ngIf="dataInformation.importType == 1" nzXs="24" nzSm="24" nzMd="12" nzLg="12" nzXl="8" nzXXl="8"
      class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "ui.receipt.GRN.requestExpirationDate" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker nzPlaceHolder="dd/mm/yyyy" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.requestExpirationDate"
            [nzDisabled]="dataInformation.status !== 0"></nz-date-picker>
        </nz-col>

      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 1 || dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12"
      nzLg="12" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{
          "manage.receipt.create.infor.person" | translate
          }}</nz-col>
        <nz-col nzSpan="24">
          <input type="text" nz-input disabled [(ngModel)]="dataInformation.createdBy" />
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 1 || dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12"
      nzLg="12" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "ui.receipt.required.createAt" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker disabled nzPlaceHolder="-- Chọn --" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.updatedAt"></nz-date-picker>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col *ngIf="dataInformation.importType == 1 || dataInformation.importType == 4" nzXs="24" nzSm="24" nzMd="12"
      nzLg="12" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "ui.receipt.required.updateAt" | translate }}
        </nz-col>
        <nz-col nzSpan="24">
          <nz-date-picker disabled nzPlaceHolder="-- Chọn --" class="w-100" nzFormat="dd/MM/yyyy"
            [(ngModel)]="dataInformation.updatedAt"></nz-date-picker>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "Mô tả" | translate }} </nz-col>
        <nz-col nzSpan="24">
          <nz-input-group [nzSuffix]="inputClearimportTypeId" class="ant-input-affix-wrapper-textarea-with-clear-btn">
            <textarea [disabled]="true" rows="1" nz-input [(ngModel)]="dataInformation.importTypeId"
              placeholder="Nhập nội dung mô tả"></textarea>
          </nz-input-group>
          <ng-template #inputClearimportTypeId>
            <span nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle"
              *ngIf="dataInformation.importTypeId" (click)="dataInformation.importTypeId = null"></span>
          </ng-template>
        </nz-col>
      </nz-row>
    </nz-col>
    <nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="8" nzXXl="8" class="mt-12">
      <nz-row>
        <nz-col nzSpan="24">{{ "table.note" | translate }} </nz-col>
        <nz-col nzSpan="24">
          <nz-input-group [nzSuffix]="inputClearNote" class="ant-input-affix-wrapper-textarea-with-clear-btn">
            <textarea [disabled]="dataInformation.status != 0" rows="1" nz-input [(ngModel)]="dataInformation.note"
              placeholder="Nhập ghi chú"></textarea>
          </nz-input-group>
          <ng-template #inputClearNote>
            <span style="display: none" nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle"
              *ngIf="dataInformation.note" (click)="dataInformation.note = null"></span>
          </ng-template>
        </nz-col>
      </nz-row>
    </nz-col>
  </nz-row>
  <nz-row class="mt-12" *ngIf="dataInformation.importType !== 3">
    <nz-col nzSpan="24">
      {{ "file.tag" | translate }}
    </nz-col>

    <nz-col class="mt-12" nzSpan="24">
      <app-upload-file (onFileChange)="onFileChange($event)" [isDisabled]="dataInformation.status != 0"
        [isUpload]="false"></app-upload-file>
    </nz-col>
    <nz-col nzSpan="24">
      <div *ngFor="let file of fileList" class="d-flex j-content-between file-custome mt-8" style="
          width: 100%;
          border-radius: 4px;
          background: #efefef;
          padding: 0 20px;
        ">
        <div style="
            color: rgba(0, 0, 0, 0.7);
            font-size: 12px;
            font-weight: 400;
            line-height: 16px;
          ">
          <div style="position: relative">
            <span class="pl-8">{{ file.fileName }}</span>
          </div>
        </div>
        <div style="display: flex">
          <div>
            <span class="mr-12 download" nz-icon nzType="download" (click)="downloadFile(file)"></span>
          </div>
        </div>
      </div>
    </nz-col>

  </nz-row>
</div>

<div class="common-bg mt-24">
  <nz-row class="mb-24">
    <h2 class="m-0">
      {{ "manage.receipt.create.list.items" | translate }}
    </h2>
  </nz-row>
  <nz-row class="mb-12">
    <app-radio-group-button [listOfButton]="listOfRadioButton"
      (onChange)="changeSelect($event)"></app-radio-group-button>
  </nz-row>
  <nz-row>
    <nz-col *ngIf="currentRadioButtonIndex == 0" nzSpan="24">
      <nz-table nzBordered [nzFrontPagination]="false" [nzShowPagination]="false" [nzScroll]="{ x: 'auto' }"
        [nzData]="listItems" #importRequestData nzSize="small" class="w-100">
        <thead>
          <tr>
            <ng-container *ngFor="let column of columns; let i = index">

              <!-- Các cột bình thường -->
              <ng-container *ngIf="
          column.check &&
          (
            column.keyName !== 'itemType' &&
            column.keyName !== 'vendorName' &&
            column.keyName !== 'status' &&
            column.keyName !== 'conclusion'
          )
        ">
                <th nz-resizable [nzWidth]="column.width" (nzResize)="onResize($event, i)" [nzMaxWidth]="500"
                  [nzMinWidth]="100">
                  <div class="editable-cell">
                    {{ column.keyTitle | translate }}
                  </div>
                  <nz-resize-handle nzDirection="right">
                    <div class="resize-trigger"></div>
                  </nz-resize-handle>
                </th>
              </ng-container>

              <!-- Cột KẾT LUẬN - chỉ hiển thị khi importType = 1 -->
              <ng-container *ngIf="column.check && column.keyName == 'conclusion' && dataInformation.importType == 1">
                <th nz-resizable [nzWidth]="column.width" (nzResize)="onResize($event, i)" [nzMaxWidth]="500"
                  [nzMinWidth]="100">
                  <div class="editable-cell">
                    {{ column.keyTitle }}
                  </div>
                  <nz-resize-handle nzDirection="right">
                    <div class="resize-trigger"></div>
                  </nz-resize-handle>
                </th>
              </ng-container>

              <!-- Cột có điều kiện theo importType (itemType, vendorName, status) -->
              <ng-container *ngIf="
          column.check &&
          (column.keyName == 'itemType' ||
           column.keyName == 'vendorName' ||
           column.keyName == 'status') &&
          dataInformation.importType !== 3
        ">
                <th nz-resizable [nzWidth]="column.width" (nzResize)="onResize($event, i)" [nzMaxWidth]="500"
                  [nzMinWidth]="100">
                  <div class="editable-cell">
                    {{ column.keyTitle | translate }}
                  </div>
                  <nz-resize-handle nzDirection="right">
                    <div class="resize-trigger"></div>
                  </nz-resize-handle>
                </th>
              </ng-container>

            </ng-container>
          </tr>
        </thead>

        <tbody [class]="listItems.length == 0 ? '' : 'striped-tr'">
          <ng-container *ngFor="let row of importRequestData.data; let i = index">
            <tr>
              <ng-container *ngFor="let column of columns; let j = index">

                <!-- Các cột bình thường -->
                <ng-container *ngIf="
            column.check &&
            column.keyName !== 'status' &&
            column.keyName !== 'requestQuantity' &&
            column.keyName !== 'itemType' &&
            column.keyName !== 'vendorName' &&
            column.keyName !== 'conclusion'
          ">
                  <td>
                    {{ row[column.keyName] }}
                  </td>
                </ng-container>

                <!-- Cột số lượng yêu cầu -->
                <ng-container *ngIf="
            column.keyName == 'requestQuantity' &&
            dataInformation.importType !== 0
          ">
                  <td nzAlign="right">
                    {{ row['requestQuantity'] | number }}
                  </td>
                </ng-container>

                <!-- Cột số lượng có thể chỉnh sửa -->
                <ng-container *ngIf="
            column.keyName == 'requestQuantity' &&
            dataInformation.importType == 3 &&
            dataInformation.status == 0
          ">
                  <td nzAlign="right">
                    <input nz-input min="1" type="number" [(ngModel)]="row[column.keyName]"
                      (ngModelChange)="onChangeRequestQuantity(row)" />
                    <span *ngIf="!row['requestQuantity']" class="error-span">
                      {{ 'warningValidate.requestQuantity' | translate }}
                    </span>
                  </td>
                </ng-container>

                <!-- Cột loại hàng -->
                <ng-container *ngIf="
            column.keyName == 'itemType' &&
            dataInformation.importType !== 3
          ">
                  <td nzAlign="right">
                    {{ row['itemType'] }}
                  </td>
                </ng-container>

                <!-- Cột trạng thái -->
                <ng-container *ngIf="
            column.check &&
            column.keyName === 'status' &&
            dataInformation.importType !== 3
          ">
                  <td nzAlign="center">
                    <div [ngSwitch]="row[column.keyName]">
                      <div class="border-element item-status_0" *ngSwitchCase="'0'">
                        {{ 'item.status.status_0' | translate }}
                      </div>
                      <div class="border-element item-status_1" *ngSwitchCase="'1'">
                        {{ 'item.status.status_1' | translate }}
                      </div>
                      <div class="border-element item-status_3" *ngSwitchCase="'3'">
                        {{ 'item.status.status_3' | translate }}
                      </div>
                      <div class="border-element item-status_2" *ngSwitchCase="'2'">
                        {{ 'item.status.status_2' | translate }}
                      </div>
                      <div class="border-element item-status_4" *ngSwitchCase="'4'">
                        {{ 'item.status.status_4' | translate }}
                      </div>
                    </div>
                  </td>
                </ng-container>

                <!-- Cột KẾT LUẬN -->
                <ng-container *ngIf="
            column.keyName == 'conclusion' &&
            dataInformation.importType == 1
          ">
                  <td nzAlign="center">
                    <select nz-input [(ngModel)]="row.conclusion" (change)="onConclusionChange(row, i)"
                      [disabled]="row.status !== 1" style="width: 100%; padding: 2px 6px;">
                      <option value="PASS">PASS</option>
                      <option value="FAILED">FAILED</option>
                    </select>

                  </td>
                </ng-container>

              </ng-container>
            </tr>
          </ng-container>
        </tbody>
      </nz-table>

    </nz-col>

  </nz-row>
  <nz-row nzAlign="top" nzJustify="end" class="w-100 mt-24" style="gap: 32px">
    <app-button [className]="'common-btn-close w-100'" [title]="'btn.close'" [buttonType]="'primary'"
      [tooltipTitle]="'Nhấp vào đây để đóng'" (btnClick)="close()">
    </app-button>
    <app-button *ngIf="checkIsRole('wms_iqc_create') && dataInformation.status === 1" [className]="'w-100 common-btn-drag'" [title]="'Cập nhật'"
      [buttonType]="'primary'" [tooltipTitle]="'Nhấp vào đây để lưu kết luận'" (btnClick)="saveDraft()">
    </app-button>
    <app-button *ngIf="
        currentStatus == 0 &&
        (checkIsRole('wms_iqc_create') || checkIsRole('FCIM_ADMIN'))
      " [className]="'w-100'" [title]="'btn.IQC'" [buttonType]="'primary'"
      [tooltipTitle]="'Nhấp vào đây để tạo yêu cầu iqc'" (btnClick)="createIqcRequest()"></app-button>
    <app-button *ngIf="
        currentStatus == 1 &&
        (checkIsRole('wms_iqc_update') || checkIsRole('FCIM_ADMIN'))
      " [className]="'w-100'" [title]="'button.withDrawIqc'" [buttonType]="'primary'"
      [tooltipTitle]="'Nhấp vào đây để thu hồi yêu cầu iqc'" (btnClick)="isVisibleConfirmWithDraw = true"></app-button>
    <app-button *ngIf="
        currentStatus == 2 &&
        (checkIsRole('wms_iqc_create') || checkIsRole('FCIM_ADMIN'))
      " [className]="'w-100'" [title]="'button.createNewIqcRequest'" [buttonType]="'primary'"
      [tooltipTitle]="'Nhấp vào đây để tạo yêu cầu iqc mới'" (btnClick)="createIqcRequest()"></app-button>
  </nz-row>
</div>

<app-popup-cancel [isVisible]="isVisibleCancel" (cancel)="onHandleCancelPopup($event)"
  (isVisibleChange)="onHandleConfirmPopup($event)">
</app-popup-cancel>

<app-popup-withdraw [isVisible]="isVisibleConfirmWithDraw" (cancel)="isVisibleConfirmWithDraw = $event"
  [importRequestCode]="dataInformation.code">
</app-popup-withdraw>